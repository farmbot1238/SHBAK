<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø´Ø¨Ø§ÙƒÙŠ - Ù…Ù†ØµØ© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#7c3aed',
                    }
                }
            }
        }
    </script>
    <!-- Ø®Ø· Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { font-family: 'Cairo', sans-serif; }
        .transition-theme {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª */
        .comments-section {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .comments-section.show {
            max-height: 1000px;
            transition: max-height 0.5s ease-in;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-theme">

    <!-- ========== Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù‚Ø¨Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„) ========== -->
    <div id="landingPage" class="min-h-screen">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…Ø¹ Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ/Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ -->
        <header class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
            <div class="container mx-auto px-4 py-4">
                <div class="flex justify-between items-center">
                    <!-- Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† -->
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center shadow-lg">
                            <i class="fa-solid fa-window-maximize text-white text-xl"></i>
                        </div>
                        <div>
                            <h1 class="text-3xl font-bold bg-gradient-to-l from-primary to-secondary bg-clip-text text-transparent">
                                Ø´Ø¨Ø§ÙƒÙŠ
                            </h1>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Ù†Ø§ÙØ°ØªÙƒ Ù„Ù„Ø¹Ø§Ù„Ù…</p>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <!-- Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ/Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ -->
                        <button onclick="toggleTheme()" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition" id="themeToggle">
                            <i class="fa-solid fa-moon text-gray-600 dark:text-gray-300 text-xl" id="themeIcon"></i>
                        </button>

                        <!-- Ø£Ø²Ø±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ -->
                        <div class="flex gap-3">
                            <button onclick="showLoginModal()" class="px-6 py-2 bg-gradient-to-r from-primary to-secondary text-white rounded-lg hover:opacity-90 transition font-semibold shadow-md">
                                <i class="fa-solid fa-right-to-bracket ml-2"></i>
                                ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
                            </button>
                            <button onclick="showRegisterModal()" class="px-6 py-2 border-2 border-primary text-primary dark:text-white dark:border-white rounded-lg hover:bg-primary/10 transition font-semibold">
                                <i class="fa-solid fa-user-plus ml-2"></i>
                                Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <main class="container mx-auto px-4 py-16">
            <div class="max-w-4xl mx-auto text-center">
                <!-- Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ -->
                <h2 class="text-5xl font-bold text-gray-800 dark:text-white mb-6">
                    Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ <span class="bg-gradient-to-l from-primary to-secondary bg-clip-text text-transparent">Ø´Ø¨Ø§ÙƒÙŠ</span>
                </h2>
                
                <!-- Ù†Ø¨Ø°Ø© Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 mb-12">
                    <div class="flex justify-center mb-6">
                        <div class="w-20 h-20 bg-gradient-to-br from-primary/20 to-secondary/20 rounded-full flex items-center justify-center">
                            <i class="fa-solid fa-window-maximize text-4xl text-primary dark:text-secondary"></i>
                        </div>
                    </div>
                    <p class="text-xl text-gray-600 dark:text-gray-300 leading-relaxed">
                        ØªØ®ÙŠÙ„ Ø£Ù† Ù„ÙƒÙ„ Ø´Ø®Øµ Ø´Ø¨Ø§ÙƒÙ‡ Ø§Ù„Ø®Ø§ØµØŒ Ù†Ø§ÙØ°Ø© ØµØºÙŠØ±Ø© ÙŠØ·Ù„ Ù…Ù†Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù…ØŒ 
                        ÙŠØ´Ø§Ø±Ùƒ Ø£ÙÙƒØ§Ø±Ù‡ØŒ ØµÙˆØ±Ù‡ØŒ ÙˆÙ„Ø­Ø¸Ø§ØªÙ‡ Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©. Ù‡Ø°Ø§ Ù‡Ùˆ <span class="font-bold text-primary">Ø´Ø¨Ø§ÙƒÙŠ</span>ØŒ
                        Ù…Ø³Ø§Ø­Ø© Ø¢Ù…Ù†Ø© Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù„Ø­Ø¸Ø§Øª Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡. ÙƒÙ„ Ø´Ø¨Ø§Ùƒ Ù„Ù‡ Ø­ÙƒØ§ÙŠØªÙ‡ØŒ 
                        ÙˆÙƒÙ„ Ù†Ø§ÙØ°Ø© ØªØ±ÙˆÙŠ Ù‚ØµØ©. Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§ ÙˆØ§ÙØªØ­ Ø´Ø¨Ø§ÙƒÙƒ Ø§Ù„Ø®Ø§Øµ!
                    </p>
                </div>

                <!-- Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-xl transition">
                        <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fa-solid fa-comments text-primary text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆÙ†Ù‚Ø§Ø´Ø§Øª</h3>
                        <p class="text-gray-600 dark:text-gray-400">Ø´Ø§Ø±Ùƒ Ø±Ø£ÙŠÙƒØŒ Ø¹Ù„Ù‚ØŒ ÙˆØ±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨ÙƒÙ„ Ø­Ø±ÙŠØ©</p>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-xl transition">
                        <div class="w-14 h-14 bg-secondary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fa-solid fa-images text-secondary text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">ØµÙˆØ± ÙˆÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h3>
                        <p class="text-gray-600 dark:text-gray-400">Ø´Ø§Ø±Ùƒ Ù„Ø­Ø¸Ø§ØªÙƒ Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ø¨ØµÙˆØ± ÙˆÙ…Ù‚Ø§Ø·Ø¹ ÙÙŠØ¯ÙŠÙˆ</p>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-xl transition">
                        <div class="w-14 h-14 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fa-solid fa-shield-halved text-green-500 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø©</h3>
                        <p class="text-gray-600 dark:text-gray-400">Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ Ù„ØªØµÙÙŠØ© Ø§Ù„ÙƒÙ„Ù…Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ========== Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„) ========== -->
    <div id="dashboard" class="hidden min-h-screen bg-gray-50 dark:bg-gray-900">
        <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="fixed right-0 top-0 w-72 h-full bg-white dark:bg-gray-800 shadow-lg z-40 transition-theme overflow-y-auto">
            <div class="p-6">
                <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
                <div class="flex items-center gap-3 mb-8">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center">
                        <i class="fa-solid fa-window-maximize text-white"></i>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">Ø´Ø¨Ø§ÙƒÙŠ</h2>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <div class="text-center mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-xl">
                    <div class="w-20 h-20 mx-auto mb-3 relative group">
                        <div class="w-full h-full rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-3xl font-bold" id="userAvatar">
                            ğŸ‘¤
                        </div>
                        <button onclick="triggerAvatarUpload()" class="absolute bottom-0 left-0 bg-primary text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition">
                            <i class="fa-solid fa-camera text-sm"></i>
                        </button>
                    </div>
                    <h3 class="font-bold text-gray-800 dark:text-white" id="userNameDisplay">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400" id="userEmailDisplay">ahmed@example.com</p>
                </div>

                <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
                <nav class="space-y-2">
                    <a href="#" onclick="showHome()" class="flex items-center gap-3 px-4 py-3 bg-primary/10 text-primary rounded-lg">
                        <i class="fa-solid fa-house"></i>
                        <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                    </a>

                    <!-- Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Ø¹Ù„Ù‰ Ø´ÙƒÙ„ ØªØ±Ø³) -->
                    <div class="relative">
                        <button onclick="toggleSettingsMenu()" class="w-full flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg transition">
                            <i class="fa-solid fa-gear"></i>
                            <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                            <i class="fa-solid fa-chevron-down mr-auto text-sm" id="settingsArrow"></i>
                        </button>
                        
                        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
                        <div id="settingsMenu" class="hidden mt-2 mr-8 space-y-2">
                            <button onclick="showProfile()" class="w-full flex items-center gap-3 px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg text-sm">
                                <i class="fa-solid fa-user"></i>
                                <span>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
                            </button>
                            <button onclick="handleLogout()" class="w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg text-sm">
                                <i class="fa-solid fa-right-from-bracket"></i>
                                <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                            </button>
                        </div>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="mr-72">
            <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
            <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-30 transition-theme">
                <div class="px-8 py-4 flex justify-between items-center">
                    <h1 class="text-2xl font-bold text-gray-800 dark:text-white" id="pageTitle">
                        Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </h1>
                    
                    <div class="flex items-center gap-4">
                        <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
                        <div class="text-left">
                            <p class="text-sm text-gray-500 dark:text-gray-400">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</p>
                            <p class="font-semibold text-gray-800 dark:text-white" id="welcomeUserName">Ø£Ø­Ù…Ø¯</p>
                        </div>
                        
                        <!-- Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙÙŠ Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ -->
                        <button onclick="toggleTheme()" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                            <i class="fa-solid fa-moon text-gray-600 dark:text-gray-300 text-xl" id="dashboardThemeIcon"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© -->
            <main class="p-8" id="mainContent">
                <!-- Ù‡Ù†Ø§ Ø±Ø­ ØªØªØ­Ø· Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø© -->
            </main>
        </div>
    </div>

    <!-- ========== Ù…ÙˆØ¯Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ========== -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-[100]">
        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-8 m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                <button onclick="hideLoginModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>

            <form onsubmit="handleLogin(event)">
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="loginEmail" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-primary to-secondary text-white py-3 rounded-lg hover:opacity-90 transition font-semibold">
                    Ø¯Ø®ÙˆÙ„
                </button>
            </form>

            <p class="text-center mt-4 text-gray-600 dark:text-gray-400">
                Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ 
                <button onclick="switchToRegister()" class="text-primary hover:underline mr-1">
                    Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
                </button>
            </p>
        </div>
    </div>

    <!-- ========== Ù…ÙˆØ¯Ø§Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ========== -->
    <div id="registerModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-[100]">
        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-8 m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <button onclick="hideRegisterModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>

            <form onsubmit="handleRegister(event)">
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ø§Ø³Ù…</label>
                    <input type="text" id="regName" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="regEmail" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="regPassword" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="regConfirmPassword" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-primary to-secondary text-white py-3 rounded-lg hover:opacity-90 transition font-semibold">
                    Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
                </button>
            </form>

            <p class="text-center mt-4 text-gray-600 dark:text-gray-400">
                Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ 
                <button onclick="switchToLogin()" class="text-primary hover:underline mr-1">
                    ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
                </button>
            </p>
        </div>
    </div>

    <!-- ========== Ù…ÙˆØ¯Ø§Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ ========== -->
    <div id="profileModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-[100]">
        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-8 m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800 dark:text-white">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h3>
                <button onclick="hideProfileModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>

            <form onsubmit="handleProfileUpdate(event)">
                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ø§Ø³Ù…</label>
                    <input type="text" id="profileName" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="profileEmail" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 dark:text-gray-300 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="password" id="profileNewPassword" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-primary to-secondary text-white py-3 rounded-lg hover:opacity-90 transition font-semibold">
                    Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                </button>
            </form>
        </div>
    </div>

    <!-- ========== JavaScript ========== -->
    <script>
        // ===== Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø© =====
        let currentUser = null;
        let isDarkMode = localStorage.getItem('theme') === 'dark';
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let posts = JSON.parse(localStorage.getItem('posts')) || [];
        const ADMIN_EMAIL = 'admin@example.com';

        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ/Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ =====
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                document.getElementById('themeIcon')?.classList.replace('fa-moon', 'fa-sun');
                document.getElementById('dashboardThemeIcon')?.classList.replace('fa-moon', 'fa-sun');
            } else {
                document.documentElement.classList.remove('dark');
                document.getElementById('themeIcon')?.classList.replace('fa-sun', 'fa-moon');
                document.getElementById('dashboardThemeIcon')?.classList.replace('fa-sun', 'fa-moon');
            }
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø¥Ø¸Ù‡Ø§Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª =====
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginModal').classList.add('flex');
        }

        function hideLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('loginModal').classList.remove('flex');
        }

        function showRegisterModal() {
            document.getElementById('registerModal').classList.remove('hidden');
            document.getElementById('registerModal').classList.add('flex');
        }

        function hideRegisterModal() {
            document.getElementById('registerModal').classList.add('hidden');
            document.getElementById('registerModal').classList.remove('flex');
        }

        function showProfileModal() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user) {
                document.getElementById('profileName').value = user.name;
                document.getElementById('profileEmail').value = user.email;
                document.getElementById('profileNewPassword').value = '';
            }
            document.getElementById('profileModal').classList.remove('hidden');
            document.getElementById('profileModal').classList.add('flex');
        }

        function hideProfileModal() {
            document.getElementById('profileModal').classList.add('hidden');
            document.getElementById('profileModal').classList.remove('flex');
        }

        function switchToRegister() {
            hideLoginModal();
            showRegisterModal();
        }

        function switchToLogin() {
            hideRegisterModal();
            showLoginModal();
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© =====
        function toggleSettingsMenu() {
            const menu = document.getElementById('settingsMenu');
            const arrow = document.getElementById('settingsArrow');
            menu.classList.toggle('hidden');
            arrow.classList.toggle('rotate-180');
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ =====
        function showHome() {
            document.getElementById('pageTitle').textContent = 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
            loadHomeContent();
        }

        function showProfile() {
            document.getElementById('pageTitle').textContent = 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ';
            loadProfileContent();
            toggleSettingsMenu(); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ·
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª)
        function loadHomeContent() {
            let html = `
                <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯ -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 mb-8">
                    <div class="flex gap-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-primary to-secondary rounded-full flex-shrink-0 flex items-center justify-center text-white font-bold" id="postAvatar">
                            ${currentUser?.name?.[0] || 'ğŸ‘¤'}
                        </div>
                        <div class="flex-1">
                            <textarea id="newPostContent" class="w-full p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Ø§ÙØªØ­ Ø´Ø¨Ø§ÙƒÙƒ ÙˆØ´Ø§Ø±Ùƒ Ù…Ø¹Ù†Ø§..." rows="3"></textarea>
                            
                            <div class="flex items-center gap-4 mt-4">
                                <button onclick="triggerImageUpload()" class="flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-primary">
                                    <i class="fa-solid fa-image text-xl"></i>
                                    <span>ØµÙˆØ±Ø©</span>
                                </button>
                                <button onclick="triggerVideoUpload()" class="flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-primary">
                                    <i class="fa-solid fa-video text-xl"></i>
                                    <span>ÙÙŠØ¯ÙŠÙˆ</span>
                                </button>
                                <button onclick="createPost()" class="mr-auto bg-gradient-to-r from-primary to-secondary text-white px-6 py-2 rounded-lg hover:opacity-90">
                                    <i class="fa-regular fa-paper-plane ml-2"></i>
                                    Ø§ÙØªØ­ Ø´Ø¨Ø§ÙƒÙƒ
                                </button>
                            </div>

                            <!-- Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù -->
                            <div id="postMediaPreview" class="hidden mt-4 relative">
                                <img id="previewImage" class="max-h-64 rounded-lg" src="" alt="Preview">
                                <video id="previewVideo" class="max-h-64 rounded-lg" controls></video>
                                <button onclick="clearPostMedia()" class="absolute top-2 left-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600">
                                    <i class="fa-solid fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª -->
                <div id="postsContainer" class="space-y-6">
            `;

            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª
            if (posts.length === 0) {
                html += `
                    <div class="text-center py-12 bg-white dark:bg-gray-800 rounded-xl">
                        <div class="text-gray-400 text-6xl mb-4">ğŸªŸ</div>
                        <p class="text-gray-500 dark:text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¨Ø¹Ø¯</p>
                        <p class="text-gray-400 text-sm mt-2">ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙØªØ­ Ø´Ø¨Ø§ÙƒÙ‡!</p>
                    </div>
                `;
            } else {
                posts.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(post => {
                    html += generatePostHTML(post);
                });
            }

            html += `</div>`;
            document.getElementById('mainContent').innerHTML = html;
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function loadProfileContent() {
            const userPosts = posts.filter(p => p.userEmail === currentUser?.email);
            
            let html = `
                <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden mb-8">
                    <div class="h-48 bg-gradient-to-r from-primary to-secondary"></div>
                    
                    <div class="px-8 pb-8 relative">
                        <div class="flex items-end gap-6 -mt-16">
                            <div class="w-32 h-32 bg-white dark:bg-gray-800 rounded-full p-1 shadow-lg">
                                <div class="w-full h-full bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white text-4xl font-bold">
                                    ${currentUser?.name?.[0] || 'ğŸ‘¤'}
                                </div>
                            </div>
                            <div class="flex-1 pb-2">
                                <h2 class="text-2xl font-bold text-gray-800 dark:text-white">${currentUser?.name}</h2>
                                <p class="text-gray-500 dark:text-gray-400">@${currentUser?.email?.split('@')[0]}</p>
                            </div>
                            <button onclick="showProfileModal()" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90">
                                <i class="fa-solid fa-pen ml-2"></i>
                                ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
                            </button>
                        </div>

                        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
                        <div class="flex gap-8 mt-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800 dark:text-white">${userPosts.length}</div>
                                <div class="text-gray-500 dark:text-gray-400">Ù…Ù†Ø´ÙˆØ±</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800 dark:text-white">${userPosts.reduce((acc, p) => acc + (p.likes || 0), 0)}</div>
                                <div class="text-gray-500 dark:text-gray-400">Ø¥Ø¹Ø¬Ø§Ø¨</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ø´Ø¨ÙƒØ© Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Ù…Ù†Ø´ÙˆØ±Ø§ØªÙŠ</h3>
                <div class="grid grid-cols-3 gap-4">
            `;

            if (userPosts.length === 0) {
                html += `
                    <div class="col-span-3 text-center py-12 bg-white dark:bg-gray-800 rounded-xl">
                        <p class="text-gray-500 dark:text-gray-400">Ù„Ù… ØªÙ†Ø´Ø± Ø£ÙŠ Ø´ÙŠØ¡ Ø¨Ø¹Ø¯</p>
                    </div>
                `;
            } else {
                userPosts.forEach(post => {
                    html += `
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm overflow-hidden">
                            ${post.media ? 
                                (post.mediaType === 'image' ? 
                                    `<img src="${post.media}" alt="Post" class="w-full h-48 object-cover">` :
                                    `<video src="${post.media}" class="w-full h-48 object-cover"></video>`
                                ) : 
                                `<div class="w-full h-48 bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center p-4">
                                    <p class="text-gray-600 dark:text-gray-300 text-center">${post.content.substring(0, 50)}...</p>
                                </div>`
                            }
                        </div>
                    `;
                });
            }

            html += `</div>`;
            document.getElementById('mainContent').innerHTML = html;
        }

        // ØªÙˆÙ„ÙŠØ¯ HTML Ù„Ù„Ù…Ù†Ø´ÙˆØ±
        function generatePostHTML(post) {
            const canDelete = currentUser?.email === post.userEmail || currentUser?.email === ADMIN_EMAIL;
            const timeAgo = getTimeAgo(post.date);
            
            return `
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6" data-post-id="${post.id}">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white font-bold">
                                ${post.userName?.[0] || 'ğŸ‘¤'}
                            </div>
                            <div>
                                <div class="flex items-center gap-2">
                                    <h4 class="font-semibold text-gray-800 dark:text-white">${post.userName}</h4>
                                    ${post.userEmail === currentUser?.email ? 
                                        '<span class="text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 px-2 py-1 rounded-full">Ø´Ø¨Ø§ÙƒÙŠ</span>' : ''}
                                </div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">${timeAgo}</p>
                            </div>
                        </div>
                        
                        ${canDelete ? `
                            <button onclick="deletePost('${post.id}')" class="text-gray-400 hover:text-red-500 transition">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>

                    <p class="text-gray-700 dark:text-gray-300 mb-4">${post.content}</p>

                    ${post.media ? `
                        ${post.mediaType === 'image' ? 
                            `<img src="${post.media}" alt="Post media" class="rounded-lg mb-4 max-h-96 w-full object-contain bg-gray-100 dark:bg-gray-700">` :
                            `<video src="${post.media}" controls class="rounded-lg mb-4 max-h-96 w-full bg-gray-100 dark:bg-gray-700"></video>`
                        }
                    ` : ''}

                    <div class="flex items-center gap-6 pt-4 border-t border-gray-100 dark:border-gray-700">
                        <button onclick="toggleLike('${post.id}')" class="flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-red-500 transition">
                            <i class="fa-regular fa-heart text-xl ${post.likedBy?.includes(currentUser?.email) ? 'text-red-500 fa-solid' : ''}"></i>
                            <span>${post.likes || 0}</span>
                        </button>
                        <button onclick="toggleComments('${post.id}')" class="flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-primary transition">
                            <i class="fa-regular fa-comment text-xl"></i>
                            <span>${post.comments?.length || 0}</span>
                        </button>
                    </div>

                    <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª - ÙˆØ§Ø¶Ø­ ÙˆÙ…Ø¨Ø§Ø´Ø± -->
                    <div id="comments-${post.id}" class="comments-section mt-4">
                        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª -->
                        <div class="space-y-4 mb-4" id="comments-list-${post.id}">
                            ${generateCommentsHTML(post.comments || [], post.id)}
                        </div>

                        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯ - ÙˆØ§Ø¶Ø­ Ø¬Ø¯Ø§Ù‹ -->
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mt-4">
                            <div class="flex gap-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-full flex-shrink-0 flex items-center justify-center text-white font-bold">
                                    ${currentUser?.name?.[0] || 'ğŸ‘¤'}
                                </div>
                                <div class="flex-1">
                                    <textarea id="comment-input-${post.id}" 
                                        class="w-full p-3 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" 
                                        placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."
                                        rows="2"></textarea>
                                    <div class="flex justify-end mt-2">
                                        <button onclick="addComment('${post.id}')" 
                                            class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 flex items-center gap-2">
                                            <i class="fa-regular fa-paper-plane"></i>
                                            <span>Ù†Ø´Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ØªÙˆÙ„ÙŠØ¯ HTML Ù„Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
        function generateCommentsHTML(comments, postId) {
            if (!comments || comments.length === 0) {
                return '<p class="text-gray-500 dark:text-gray-400 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯. ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¹Ù„Ù‚!</p>';
            }
            
            return comments.map(comment => `
                <div class="flex gap-3 group">
                    <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-full flex-shrink-0 flex items-center justify-center text-white text-sm font-bold">
                        ${comment.userName?.[0] || 'ğŸ‘¤'}
                    </div>
                    <div class="flex-1">
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-3">
                            <div class="flex items-center justify-between mb-1">
                                <span class="font-semibold text-sm text-gray-800 dark:text-white">${comment.userName}</span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">${getTimeAgo(comment.date)}</span>
                            </div>
                            <p class="text-sm text-gray-700 dark:text-gray-300">${comment.content}</p>
                            
                            <!-- Ø²Ø± Ø§Ù„Ø±Ø¯ -->
                            <button onclick="showReplyInput('${postId}', '${comment.id}')" class="text-xs text-primary hover:underline mt-2 flex items-center gap-1">
                                <i class="fa-regular fa-reply"></i>
                                Ø±Ø¯
                            </button>

                            <!-- Ø­Ù‚Ù„ Ø§Ù„Ø±Ø¯ -->
                            <div id="reply-${postId}-${comment.id}" class="hidden mt-3">
                                <div class="flex gap-2">
                                    <input type="text" 
                                           id="reply-input-${postId}-${comment.id}"
                                           class="flex-1 px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"
                                           placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ..."
                                           onkeypress="if(event.key === 'Enter') addReply('${postId}', '${comment.id}')">
                                    <button onclick="addReply('${postId}', '${comment.id}')" class="bg-primary text-white px-3 py-2 rounded-lg hover:bg-primary/90 text-sm">
                                        <i class="fa-regular fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Ø§Ù„Ø±Ø¯ÙˆØ¯ -->
                            ${comment.replies ? generateRepliesHTML(comment.replies) : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ØªÙˆÙ„ÙŠØ¯ HTML Ù„Ù„Ø±Ø¯ÙˆØ¯
        function generateRepliesHTML(replies) {
            if (!replies || replies.length === 0) return '';
            
            return `
                <div class="mr-8 mt-3 space-y-3">
                    ${replies.map(reply => `
                        <div class="flex gap-2">
                            <div class="w-6 h-6 bg-gradient-to-br from-primary/70 to-secondary/70 rounded-full flex-shrink-0 flex items-center justify-center text-white text-xs font-bold">
                                ${reply.userName?.[0] || 'ğŸ‘¤'}
                            </div>
                            <div class="flex-1 bg-gray-100 dark:bg-gray-600 rounded-lg p-2">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="font-semibold text-xs text-gray-800 dark:text-white">${reply.userName}</span>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">${getTimeAgo(reply.date)}</span>
                                </div>
                                <p class="text-sm text-gray-700 dark:text-gray-300">${reply.content}</p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        function getTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const seconds = Math.floor((now - date) / 1000);
            
            if (seconds < 60) return 'Ù…Ù†Ø° Ù„Ø­Ø¸Ø§Øª';
            if (seconds < 3600) return `Ù…Ù†Ø° ${Math.floor(seconds / 60)} Ø¯Ù‚ÙŠÙ‚Ø©`;
            if (seconds < 86400) return `Ù…Ù†Ø° ${Math.floor(seconds / 3600)} Ø³Ø§Ø¹Ø©`;
            return `Ù…Ù†Ø° ${Math.floor(seconds / 86400)} ÙŠÙˆÙ…`;
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„ =====
        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('dashboard').classList.remove('hidden');
                document.getElementById('welcomeUserName').textContent = user.name.split(' ')[0];
                document.getElementById('userNameDisplay').textContent = user.name;
                document.getElementById('userEmailDisplay').textContent = user.email;
                document.getElementById('userAvatar').textContent = user.name[0];
                
                hideLoginModal();
                loadHomeContent();
            } else {
                alert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        function handleRegister(event) {
            event.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const confirmPass = document.getElementById('regConfirmPassword').value;

            if (password !== confirmPass) {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©');
                return;
            }

            if (users.some(u => u.email === email)) {
                alert('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                return;
            }

            const newUser = {
                id: Date.now().toString(),
                name,
                email,
                password,
                avatar: null,
                date: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†');
            hideRegisterModal();
            showLoginModal();
        }

        function handleLogout() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                currentUser = null;
                localStorage.removeItem('currentUser');
                document.getElementById('dashboard').classList.add('hidden');
                document.getElementById('landingPage').style.display = 'block';
                toggleSettingsMenu(); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            }
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª =====
        function createPost() {
            const content = document.getElementById('newPostContent').value;
            if (!content.trim()) {
                alert('Ø§ÙƒØªØ¨ Ø´ÙŠØ¦Ø§Ù‹ Ù„Ù…Ø´Ø§Ø±ÙƒØªÙ‡');
                return;
            }

            // ÙÙ„ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ù…Ù†ÙˆØ¹Ø©
            const bannedWords = ['Ø³ÙƒØ³', 'sex', 'porn', 'Ù†ÙŠÙƒ', 'ÙƒØ³', 'Ø²Ø¨', 'Ø·ÙŠØ²', 'Ø¹Ø±Øµ', 'Ù‚Ø­Ø¨Ø©'];
            const lowerContent = content.toLowerCase();
            for (let word of bannedWords) {
                if (lowerContent.includes(word)) {
                    alert(`Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙƒÙ„Ù…Ø© ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨Ø©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„`);
                    return;
                }
            }

            const newPost = {
                id: Date.now().toString(),
                content: content,
                userEmail: currentUser.email,
                userName: currentUser.name,
                date: new Date().toISOString(),
                likes: 0,
                likedBy: [],
                comments: [],
                media: document.getElementById('previewImage').src || null,
                mediaType: document.getElementById('previewImage').src ? 'image' : 
                           document.getElementById('previewVideo').src ? 'video' : null
            };

            posts.unshift(newPost);
            localStorage.setItem('posts', JSON.stringify(posts));

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
            document.getElementById('newPostContent').value = '';
            clearPostMedia();
            loadHomeContent();
        }

        function deletePost(postId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ±ØŸ')) {
                posts = posts.filter(p => p.id !== postId);
                localStorage.setItem('posts', JSON.stringify(posts));
                loadHomeContent();
            }
        }

        function toggleLike(postId) {
            const post = posts.find(p => p.id === postId);
            if (post) {
                if (post.likedBy?.includes(currentUser.email)) {
                    post.likes--;
                    post.likedBy = post.likedBy.filter(e => e !== currentUser.email);
                } else {
                    post.likes = (post.likes || 0) + 1;
                    post.likedBy = [...(post.likedBy || []), currentUser.email];
                }
                localStorage.setItem('posts', JSON.stringify(posts));
                loadHomeContent();
            }
        }

        function toggleComments(postId) {
            const commentsDiv = document.getElementById(`comments-${postId}`);
            commentsDiv.classList.toggle('show');
        }

        function addComment(postId) {
            const textarea = document.getElementById(`comment-input-${postId}`);
            const content = textarea.value.trim();
            
            if (!content) {
                alert('Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            const post = posts.find(p => p.id === postId);
            if (post) {
                if (!post.comments) post.comments = [];
                
                const newComment = {
                    id: Date.now().toString(),
                    content: content,
                    userEmail: currentUser.email,
                    userName: currentUser.name,
                    date: new Date().toISOString(),
                    replies: []
                };

                post.comments.push(newComment);
                localStorage.setItem('posts', JSON.stringify(posts));
                
                textarea.value = '';
                loadHomeContent();
                
                // ØªØ£ÙƒØ¯ Ù…Ù† Ø¸Ù‡ÙˆØ± Ù‚Ø³Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
                document.getElementById(`comments-${postId}`).classList.add('show');
            }
        }

        function showReplyInput(postId, commentId) {
            const replyDiv = document.getElementById(`reply-${postId}-${commentId}`);
            replyDiv.classList.toggle('hidden');
            if (!replyDiv.classList.contains('hidden')) {
                document.getElementById(`reply-input-${postId}-${commentId}`).focus();
            }
        }

        function addReply(postId, commentId) {
            const input = document.getElementById(`reply-input-${postId}-${commentId}`);
            const content = input.value.trim();
            
            if (!content) return;

            const post = posts.find(p => p.id === postId);
            if (post) {
                const comment = post.comments.find(c => c.id === commentId);
                if (comment) {
                    if (!comment.replies) comment.replies = [];
                    
                    comment.replies.push({
                        id: Date.now().toString(),
                        content: content,
                        userEmail: currentUser.email,
                        userName: currentUser.name,
                        date: new Date().toISOString()
                    });

                    localStorage.setItem('posts', JSON.stringify(posts));
                    input.value = '';
                    document.getElementById(`reply-${postId}-${commentId}`).classList.add('hidden');
                    loadHomeContent();
                }
            }
        }

        // ===== Ø¯ÙˆØ§Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª =====
        function triggerImageUpload() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file.size > 5 * 1024 * 1024) {
                    alert('Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('previewImage').src = e.target.result;
                    document.getElementById('previewImage').classList.remove('hidden');
                    document.getElementById('previewVideo').classList.add('hidden');
                    document.getElementById('postMediaPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }

        function triggerVideoUpload() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'video/*';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file.size > 50 * 1024 * 1024) {
                    alert('Ø­Ø¬Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('previewVideo').src = e.target.result;
                    document.getElementById('previewVideo').classList.remove('hidden');
                    document.getElementById('previewImage').classList.add('hidden');
                    document.getElementById('postMediaPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }

        function clearPostMedia() {
            document.getElementById('postMediaPreview').classList.add('hidden');
            document.getElementById('previewImage').src = '';
            document.getElementById('previewVideo').src = '';
        }

        function triggerAvatarUpload() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file.size > 2 * 1024 * 1024) {
                    alert('Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 2 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ localStorage
                    if (currentUser) {
                        currentUser.avatar = e.target.result;
                        localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                        const userIndex = users.findIndex(u => u.email === currentUser.email);
                        if (userIndex !== -1) {
                            users[userIndex].avatar = e.target.result;
                            localStorage.setItem('users', JSON.stringify(users));
                        }
                        
                        alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­');
                    }
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }

        // ===== Ø¯ÙˆØ§Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ =====
        function handleProfileUpdate(event) {
            event.preventDefault();
            const newName = document.getElementById('profileName').value;
            const newEmail = document.getElementById('profileEmail').value;
            const newPassword = document.getElementById('profileNewPassword').value;

            if (currentUser) {
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                currentUser.name = newName;
                currentUser.email = newEmail;
                if (newPassword) {
                    currentUser.password = newPassword;
                }

                // ØªØ­Ø¯ÙŠØ« ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('users', JSON.stringify(users));
                }

                localStorage.setItem('currentUser', JSON.stringify(currentUser));

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                document.getElementById('userNameDisplay').textContent = newName;
                document.getElementById('userEmailDisplay').textContent = newEmail;
                document.getElementById('welcomeUserName').textContent = newName.split(' ')[0];
                document.getElementById('userAvatar').textContent = newName[0];
                document.getElementById('postAvatar').textContent = newName[0];

                alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø¨Ù†Ø¬Ø§Ø­');
                hideProfileModal();
            }
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ù‡ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = function() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('dashboard').classList.remove('hidden');
                document.getElementById('welcomeUserName').textContent = currentUser.name.split(' ')[0];
                document.getElementById('userNameDisplay').textContent = currentUser.name;
                document.getElementById('userEmailDisplay').textContent = currentUser.email;
                document.getElementById('userAvatar').textContent = currentUser.name[0];
                document.getElementById('postAvatar').textContent = currentUser.name[0];
                loadHomeContent();
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù…Ù† localStorage
            users = JSON.parse(localStorage.getItem('users')) || [];
            posts = JSON.parse(localStorage.getItem('posts')) || [];
        }
    </script>
</body>
</html>
